"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"gzipJson",{enumerable:true,get:function(){return gzipJson}});require("core-js/modules/es.global-this.js");require("core-js/modules/es.object.to-string.js");require("core-js/modules/es.regexp.to-string.js");require("core-js/modules/es.array.from.js");require("core-js/modules/es.string.iterator.js");require("core-js/modules/web.dom-exception.constructor.js");require("core-js/modules/web.dom-exception.stack.js");require("core-js/modules/web.dom-exception.to-string-tag.js");require("core-js/modules/web.btoa.js");require("core-js/modules/es.array.push.js");require("core-js/modules/es.typed-array.at.js");require("core-js/modules/es.typed-array.copy-within.js");require("core-js/modules/es.typed-array.every.js");require("core-js/modules/es.typed-array.fill.js");require("core-js/modules/es.typed-array.filter.js");require("core-js/modules/es.typed-array.find.js");require("core-js/modules/es.typed-array.find-index.js");require("core-js/modules/es.typed-array.find-last.js");require("core-js/modules/es.typed-array.find-last-index.js");require("core-js/modules/es.typed-array.for-each.js");require("core-js/modules/es.typed-array.includes.js");require("core-js/modules/es.typed-array.index-of.js");require("core-js/modules/es.typed-array.iterator.js");require("core-js/modules/es.typed-array.join.js");require("core-js/modules/es.typed-array.last-index-of.js");require("core-js/modules/es.typed-array.map.js");require("core-js/modules/es.typed-array.reduce.js");require("core-js/modules/es.typed-array.reduce-right.js");require("core-js/modules/es.typed-array.reverse.js");require("core-js/modules/es.typed-array.set.js");require("core-js/modules/es.typed-array.slice.js");require("core-js/modules/es.typed-array.some.js");require("core-js/modules/es.typed-array.sort.js");require("core-js/modules/es.typed-array.subarray.js");require("core-js/modules/es.typed-array.to-locale-string.js");require("core-js/modules/es.typed-array.to-reversed.js");require("core-js/modules/es.typed-array.to-sorted.js");require("core-js/modules/es.typed-array.to-string.js");require("core-js/modules/es.typed-array.with.js");require("core-js/modules/es.array.iterator.js");require("core-js/modules/es.array-buffer.slice.js");require("core-js/modules/es.typed-array.uint8-array.js");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _async_to_generator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _ts_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),"throw":verb(1),"return":verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}}var u8ToBase64=function(u8){var _g_Buffer;var g=globalThis;if((_g_Buffer=g.Buffer)===null||_g_Buffer===void 0?void 0:_g_Buffer.from){return g.Buffer.from(u8).toString("base64")}var bin="";var CHUNK=32768;for(var i=0;i<u8.length;i+=CHUNK){var sub=u8.subarray(i,i+CHUNK);bin+=String.fromCharCode.apply(null,Array.from(sub))}return btoa(bin)};var hasCompressionStream=function(){try{if(typeof CompressionStream==="undefined")return false;new CompressionStream("gzip");return true}catch(e){return false}};var gzipJson=function(){var _ref=_async_to_generator(function(json){var gzStream,buf,err;return _ts_generator(this,function(_state){switch(_state.label){case 0:_state.trys.push([0,3,,4]);if(!hasCompressionStream())return[3,2];gzStream=new Blob([json]).stream().pipeThrough(new CompressionStream("gzip"));return[4,new Response(gzStream).arrayBuffer()];case 1:buf=_state.sent();return[2,u8ToBase64(new Uint8Array(buf))];case 2:if(typeof TextEncoder!=="undefined"){return[2,u8ToBase64(new TextEncoder().encode(json))]}return[2,btoa(unescape(encodeURIComponent(json)))];case 3:err=_state.sent();console.error("[gzipJson] failed:",err);try{if(typeof TextEncoder!=="undefined"){return[2,u8ToBase64(new TextEncoder().encode(json))]}return[2,btoa(unescape(encodeURIComponent(json)))]}catch(e2){console.error("[gzipJson] fallback base64 failed:",e2);return[2,json]}return[3,4];case 4:return[2]}})});return function gzipJson(json){return _ref.apply(this,arguments)}}();